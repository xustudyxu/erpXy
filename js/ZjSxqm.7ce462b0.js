(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ZjSxqm"],{"1ee25":function(t,s,e){"use strict";var a=e("76ad"),i=e.n(a);i.a},"6a1c":function(t,s){t.exports="data:image/png;base64,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"},"6ba4":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"renzheng"},[a("headerBar",{attrs:{"header-data":t.headerData}}),a("div",{staticClass:"container"},[a("div",{staticClass:"content"},[a("div",{staticClass:"common-main box"},[t._m(0),a("div",{staticClass:"cert-content",on:{click:function(s){return t.goScan()}}},[t._m(1)])])]),"1"==t.actionCode?a("div",{staticClass:"content"},[a("div",{staticClass:"common-main box"},[t._m(2),a("div",{staticClass:"cert-content",on:{click:function(s){return t.goFace()}}},[t.idCard?t._e():a("div",{staticClass:"cert-icon"},[a("img",{attrs:{src:e("7207")}})]),a("div",{staticClass:"cert-result"},[t.idCard?a("div",{staticClass:"result-icon"},[a("img",{staticStyle:{width:"200px",height:"300px"},attrs:{src:t.faceImage}})]):t._e(),t.idCard?a("div",{staticClass:"result-text"},[a("img",{attrs:{src:e("6e72")}}),t._v("脸部识别成功")]):t._e()])])])]):t._e(),a("div",{staticClass:"content"},[a("div",{staticClass:"common-main box"},[a("div",{staticClass:"title"},["1"==t.actionCode?a("div",{staticClass:"title-left"},[a("h2",[t._v("3、请签名")])]):a("div",{staticClass:"title-left"},[a("h2",[t._v("2、请签名")])])]),a("div",{staticClass:"cert-content",attrs:{id:"btn"},on:{click:function(s){return t.goSing()}}},[a("div",{staticClass:"cert-icon"},[a("img",{attrs:{src:t.handImage}})])])])])]),a("div",{attrs:{hidden:t.hidden}},[a("van-popup",{style:{height:"100%"},attrs:{position:"bottom",closeable:"",round:""},model:{value:t.showqm,callback:function(s){t.showqm=s},expression:"showqm"}},[a("div",{staticClass:"container-mini"},[a("div",{staticClass:"canvas-content"},[a("canvas",{ref:"canvasF",on:{touchstart:t.touchStart,touchmove:t.touchMove,touchend:t.touchEnd,mousedown:t.mouseDown,mousemove:t.mouseMove,mouseup:t.mouseUp}})]),a("div",{staticClass:"foot-btn fixed sideleft"},[a("ul",[a("li",[a("van-button",{attrs:{type:"info",size:"large",plain:"",round:""},on:{click:t.back}},[t._v("返回")])],1),a("li",[a("van-button",{attrs:{id:"reset",type:"info",size:"large",plain:"",round:""},on:{click:t.overwrite}},[t._v("清除")])],1),a("li",[a("van-button",{attrs:{id:"get",type:"info",size:"large",round:""},on:{click:t.commit}},[t._v("确定")])],1)])])])])],1)],1)},i=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"title"},[e("div",{staticClass:"title-left"},[e("h2",[t._v("1、扫描需要识别的二维码")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"cert-icon"},[a("img",{attrs:{src:e("5747")}})])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"title"},[e("div",{staticClass:"title-left"},[e("h2",[t._v("2、请完成脸部识别")])])])}],n=(e("c975"),e("ace4"),e("b0c0"),e("d3b7"),e("466d"),e("1276"),e("5cc6"),e("9a8c"),e("a975"),e("735e"),e("c1ac"),e("d139"),e("3a7b"),e("d5d6"),e("82f8"),e("e91f"),e("60bd"),e("5f96"),e("3280"),e("3fcc"),e("ca91"),e("25a1"),e("cd26"),e("3c5d"),e("2954"),e("649e"),e("219c"),e("170b"),e("b39a9"),e("72f7"),e("445c")),o=e("510f"),c={name:"ZjSxqm",components:{headerBar:n["a"]},mixins:[o["d"],o["b"]],data:function(){return{stageInfo:"",client:{},points:[],canvasTxt:null,startX:0,startY:0,moveY:0,moveX:0,endY:0,endX:0,w:null,h:null,isDown:!1,isViewAutograph:this.$route.query.isViews>0,contractSuccess:this.$route.query.contractSuccess,hidden:!0,width:"",height:"",idCard:!1,file1:"",file2:"",token:"",zjmessage:"",baseurl:"",isScan:!1,handImage:e("6a1c"),faceImage:"",actionCode:"",showqm:!0,headerData:{title:"电子签名",leftUrl:"back",leftText:" "}}},watch:{Native_ScanData:function(t){console.info("val===0==",t.name),t&&(console.info("val===1==",t.name),this.token=t.name,this.getScanData(t.name))},Native_PhoneImageData:function(t){console.info("val===0==",t),t&&("face"===t.name?(this.file1=t.images,this.getFaceData(t.images)):(this.file2=t.images,this.getSingImage(t.images)))}},mounted:function(){var t=this.$refs.canvasF;t.height=window.innerHeight,t.width=window.innerWidth,this.canvasTxt=t.getContext("2d"),this.canvasTxt.lineWidth="10",this.canvasTxt.lineCap="round",this.canvasTxt.LineJoin="round",this.stageInfo=t.getBoundingClientRect()},created:function(){},methods:{touchStart:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var s={x:t.targetTouches[0].clienX,y:t.targetTouches[0].clientY};this.startX=s.x,this.startY=s.y,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(s.x,s.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(s)}},touchMove:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var s={x:t.targetTouches[0].clientX-this.stageInfo.left,y:t.targetTouches[0].clientY-this.stageInfo.top};this.moveY=s.y,this.moveX=s.x,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(s.x,s.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.startY=s.y,this.startX=s.x,this.points.push(s)}},touchEnd:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var s={x:t.targetTouches[0].clientX-this.stageInfo.left,y:t.targetTouches[0].clientY-this.stageInfo.top};this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(s.x,s.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(s)}},mouseDown:function(t){t=t||event,t.preventDefault();var s={x:t.offsetX,y:t.offsetY};this.startX=s.x,this.startY=s.y,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(s.x,s.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(s),this.isDown=!0},mouseMove:function(t){if(t=t||event,t.preventDefault(),this.isDown){var s={x:t.offsetX,y:t.offsetY};this.moveY=s.y,this.moveX=s.x,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(s.x,s.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.startY=s.y,this.startX=s.x,this.points.push(s)}},mouseUp:function(t){t=t||event,t.preventDefault();var s={x:t.offsetX,y:t.offsetY};this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(s.x,s.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(s),this.points.push({x:-1,y:-1}),this.isDown=!1},back:function(){this.hidden=!0},overwrite:function(){this.canvasTxt.clearRect(0,0,this.$refs.canvasF.width,this.$refs.canvasF.height),this.points=[]},commit:function(){this.rotateBase64Img(this.$refs.canvasF.toDataURL(),270),this.hidden=!0},rotateBase64Img:function(t,s){var e,a,i,n=this,o=document.createElement("canvas"),c=o.getContext("2d");s%90!==0&&console.error("旋转角度必须是90的倍数!"),s<0&&(s=s%360+360);var h=s/90%4,r={sx:0,sy:0,ex:0,ey:0},l=new Image;l.crossOrigin="anonymous",l.src=t,l.onload=function(){switch(e=l.width,a=l.height,i=e>a?e:a,o.width=2*i,o.height=2*i,h){case 0:r.sx=i,r.sy=i,r.ex=i+e,r.ey=i+a;break;case 1:r.sx=i-a,r.sy=i,r.ex=i,r.ey=i+e;break;case 2:r.sx=i-e,r.sy=i-a,r.ex=i,r.ey=i;break;case 3:r.sx=i,r.sy=i-e,r.ex=i+a,r.ey=i+e;break}c.translate(i,i),c.rotate(s*Math.PI/180),c.drawImage(l,0,0);var t=c.getImageData(r.sx,r.sy,r.ex,r.ey);h%2===0?(o.width=e,o.height=a):(o.width=a,o.height=e),c.putImageData(t,0,0);var d=o.toDataURL();n.getSingImage(d),n.handImage=d,n.$store.state.qmUrl=d}},showQmPopup:function(){this.hidden=!1},goHome:function(){this.$router.push("/MhHome")},dataURLtoFile:function(t,s){var e=t.split(","),a=e[0].match(/:(.*?);/)[1],i=atob(e[1]),n=i.length,o=new Uint8Array(n);while(n--)o[n]=i.charCodeAt(n);return new File([o],s,{type:a})},goBackPage:function(){this.$router.push("zjhome")},goBack:function(){try{window.myapp.backRoute()}catch(t){console.log(t)}try{window.webkit.messageHandlers.backRoute.postMessage()}catch(t){console.log(t)}},goScan:function(){this.NativeScan()},getScanData:function(t){var s=this;this.$store.dispatch("zj/getSfxxAction",this.token).then((function(t){if(t=JSON.parse(t),s.zjmessage=t,console.log("zjmessage=========",t),null!==t){if(s.isScan=!0,2!==t.method)return s.idCard=!1,void s.$toast.fail("二维码错误！");s.idCard=!0,s.actionCode="2",s.baseurl=t.url,s.$toast("扫描成功")}else s.$toast.fail("二维码信息错误，请核对二维码")})).catch((function(t){s.$toast(t),console.log("error=====",t)}))},goFace:function(){this.actionCode?this.NativePhone(3001):this.$toast("请先进行二维码扫描")},getFaceData:function(t){var s=this,e=new FormData;e.append("file",this.dataURLtoFile(t,"i.png"),"head_image"),e.append("idcard",this.zjmessage.idcard),e.append("name",this.zjmessage.name),this.$store.dispatch("zj/matchIdcardPhotoAction",{token:this.token,data:e,baseurl:this.baseurl}).then((function(t){s.faceImage=s.file1,s.$toast.success("人脸识别成功！"),console.log("res=====",t)})).catch((function(t){s.$toast(t),console.log("error=====",t)}))},goSing:function(){this.isScan?(this.showqm=!0,this.overwrite(),this.hidden=!1):this.$toast("请先进行二维码扫描")},is_phone:function(){var t=navigator.userAgent,s=t.indexOf("Android")>-1||t.indexOf("Linux")>-1,e=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);return!!s||!e&&void 0},getSingImage:function(t){var s=this,e=JSON.stringify({images:t}),a={gg_smjl_retmsg:e};this.$store.dispatch("zj/updateHandImageAction",{data:a,baseurl:this.zjmessage.qmurl,token:this.token}).then((function(e){s.handImage=t,s.$toast.success("签名成功！"),console.log("res=====",e)})).catch((function(t){s.$toast(t),console.log("error=====",t)}))}}},h=c,r=(e("1ee25"),e("2877")),l=Object(r["a"])(h,a,i,!1,null,"403b0040",null);s["default"]=l.exports},"76ad":function(t,s,e){}}]);
//# sourceMappingURL=ZjSxqm.7ce462b0.js.map